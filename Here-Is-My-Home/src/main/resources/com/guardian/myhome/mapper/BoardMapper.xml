<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.guardian.myhome.mapper.BoardMapper">
	
	<!-- 같은 동네 목록 리스트 -->
<!-- 	<select id="getList" resultType="com.guardian.myhome.vo.BoardVO">
		SELECT B.*, I.nickname, I.addr FROM Board B, Imcha_tb I WHERE B.IMCHA_ID = I.IMCHA_ID AND addr = #{addr}
	</select> -->
	
	<!-- 전국 목록 리스트 -->
	<select id="getAllList" resultType="com.guardian.myhome.vo.BoardVO">
		<![CDATA[SELECT B.*, I.nickname, I.addr FROM Board B, Imcha_tb I WHERE B.IMCHA_ID = I.IMCHA_ID AND bno > 0]]>
	</select>
	
	<!-- 카테고리별 목록 리스트 -->
	<select id="getCategoryList" resultType="com.guardian.myhome.vo.BoardVO">
		SELECT B.*, I.nickname, I.addr FROM Board B, Imcha_tb I WHERE B.IMCHA_ID = I.IMCHA_ID AND CATEGORY = #{category}
	</select>
	
	<!-- INSERT처리만 되고 생성된 PK값을 알 필요가 없는 경우 -->
	<insert id="insert">
		INSERT INTO Board (BNO, IMCHA_ID, TITLE, CATEGORY, CONTENT) VALUES (SEQ_BNO.NEXTVAL, #{imchaid}, #{title}, #{category}, #{content})
	</insert>
	
	<!-- INSERT처리도 되고 생성된 PK값을 알아야 하는 경우 -->
	<insert id="insertSelectKey">
		<selectKey keyProperty="bno" order="BEFORE" resultType="long"> SELECT SEQ_BNO.NEXTVAL FROM dual </selectKey>
		INSERT INTO Board (BNO, IMCHA_ID, TITLE, CATEGORY, CONTENT) VALUES (#{bno}, #{imchaid}, #{title}, #{category}, #{content})
	</insert>
	
	<!-- 조회 -->
	<select id="read" resultType="com.guardian.myhome.vo.BoardVO">
		SELECT B.*, I.nickname, I.addr FROM Board B, Imcha_tb I WHERE B.IMCHA_ID = I.IMCHA_ID AND bno = #{bno}
	</select>
	
	<!-- 삭제 -->
	<delete id="delete">
		DELETE FROM Board WHERE bno = #{bno}
	</delete>
	
	<!-- 수정 -->
	<update id="update">
		UPDATE Board SET TITLE=#{title}, CONTENT=#{content}, CATEGORY=#{category}, UPDATEDATE = SYSDATE WHERE bno = #{bno}
	</update>
	
	<!-- 조회수 증가  -->
	<update id="viewsUp">
		UPDATE Board SET views = views+1 WHERE bno = #{bno}
	</update>
	
	<!-- 좋아요 증가 -->
	<update id="likesUp">
		UPDATE Board SET likes = likes+1 WHERE bno = #{bno}
	</update>

</mapper>

	